{% extends "base.html" %}

{% block title %}ì¶”ì²œ ë¡œë“œë§µ - ON:AIR{% endblock %}
{% block body_class %}roadmap-page{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='styles/roadmap.css') }}">
  <style>
    /* ë¯¸ë‹ˆì¹´ë“œ ì¬ìƒ ë²„íŠ¼ */
    .mini-card{ position:relative; }
    .mini-card .mini-play{
      position:absolute; top:10px; right:10px;
      width:36px; height:36px; border-radius:50%;
      border:0; background:var(--brand); color:#fff;
      display:flex; align-items:center; justify-content:center;
      box-shadow:0 8px 18px rgba(91,123,255,.25), 0 0 0 3px #fff;
      cursor:pointer;
      transition:transform .12s ease, background .18s ease, box-shadow .18s ease;
    }
    .mini-card .mini-play svg{ fill:#fff }
    .mini-card .mini-play:hover{
      background:var(--brand-ink);
      transform:translateY(-1px) scale(1.04);
      box-shadow:0 10px 22px rgba(91,123,255,.30), 0 0 0 3px #fff;
    }
    .mini-card .mini-play:active{ transform:translateY(0) scale(.98) }
  </style>
{% endblock %}

{% block content %}
<main class="container">

  <!-- ===== ì„œë¸Œí—¤ë” ===== -->
  <div class="subhead">
    <div class="subhead-inner">
      <nav class="sub-tabs">
        <a href="{{ url_for('roadmap') }}"  class="subtab" {% if is_active('roadmap') %}aria-current="page"{% endif %}>ê°•ì˜ì‹¤</a>
        <a href="{{ url_for('guide') }}"    class="subtab" {% if is_active('guide') %}aria-current="page"{% endif %}>ìˆ˜ê°• ì•ˆë‚´</a>
        <a href="{{ url_for('reviews') }}"  class="subtab" {% if is_active('reviews') %}aria-current="page"{% endif %}>ìˆ˜ê°• í›„ê¸°</a>
        <a href="{{ url_for('membership') }}" class="subtab" {% if is_active('membership') %}aria-current="page"{% endif %}>ë©¤ë²„ì‹­ ì•ˆë‚´</a>
      </nav>

      <form class="sub-search" role="search" method="get" action="#">
        <input id="subSearchInput" type="search" name="q" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”." autocomplete="off" />
        <button type="submit" class="icon-btn">ğŸ”</button>
      </form>
    </div>
  </div>

  <!-- ì¹´í…Œê³ ë¦¬ -->
  <nav class="category-nav">
    <button class="cat is-active" data-cat="all"><span>ì „ì²´</span></button>
    <button class="cat" data-cat="phone"><span>ì „í™”</span></button>
    <button class="cat" data-cat="interview"><span>ë©´ì ‘</span></button>
    <button class="cat" data-cat="chat"><span>ì±„íŒ…</span></button>
    <button class="cat" data-cat="daily"><span>ì¼ìƒ</span></button>
  </nav>

  <!-- ===== ì¶”ì²œ ë¡œë“œë§µ ===== -->
  <section>
    <header class="section-head">
      <h2>ì¶”ì²œ ë¡œë“œë§µ</h2>
      <a class="more" href="#">ë¡œë“œë§µ ìƒì„¸ë³´ê¸°</a>
    </header>

    <!-- ===== ê·¸ë£¹ 1: ì „í™” ===== -->
    <div class="roadmap-group">
      <article class="course-main" data-cat="phone">
        <div class="thumb">
          <img src="{{ url_for('static', filename='assets/image/call.png') }}" alt="ì½œí¬ë¹„ì•„ ê·¹ë³µ">
        </div>
        <div class="body">
          <h3 class="title">ì½œí¬ë¹„ì•„ ê·¹ë³µ</h3>
          <p class="desc">ê¸°ë³¸ í˜¸í¡Â·í˜¸ì¶œ ë©˜íŠ¸ë¡œ ì‹œì‘í•´ë³´ëŠ” ì „í™” ì²« ë‹¨ê³„</p>
        </div>
      </article>

      <div class="course-minis">
        <div class="nav prev" onclick="scrollTrack(this,-1)">&#10094;</div>
        <div class="track">
          <article class="mini-card">
            <div class="chips"><span class="chip">ì „í™”</span></div>
            <h4 class="mini-title">ìƒë‹´ ì˜ˆì•½</h4>
            <button class="mini-play" data-scenario="call_consult">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ì „í™”</span></div>
            <h4 class="mini-title">ë°°ì†¡ ë¬¸ì˜</h4>
            <button class="mini-play" data-scenario="call_shipping">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ì „í™”</span></div>
            <h4 class="mini-title">ì˜ˆì•½ ë³€ê²½</h4>
            <button class="mini-play" data-scenario="call_reschedule">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
        </div>
        <div class="nav next" onclick="scrollTrack(this,1)">&#10095;</div>
      </div>
    </div>

    <!-- ===== ê·¸ë£¹ 2: ì±„íŒ… ===== -->
    <div class="roadmap-group">
      <article class="course-main" data-cat="chat">
        <div class="thumb">
          <img src="{{ url_for('static', filename='assets/image/chati.png') }}" alt="ì±„íŒ… ë¬¸ì˜">
        </div>
        <div class="body">
          <h3 class="title">ì±„íŒ…ìœ¼ë¡œ ë¬¸ì˜í•˜ê¸°</h3>
          <p class="desc">ìƒí™©ì— ë§ëŠ” í†¤Â·ë§¤ë„ˆë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ë¬»ê³  ë‹µí•˜ê¸°</p>
        </div>
      </article>

      <div class="course-minis">
        <div class="nav prev" onclick="scrollTrack(this,-1)">&#10094;</div>
        <div class="track">
          <article class="mini-card">
            <div class="chips"><span class="chip">ì±„íŒ…</span></div>
            <h4 class="mini-title">êµí™˜ ë¬¸ì˜</h4>
            <button class="mini-play" data-scenario="chat_exchange">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ì±„íŒ…</span></div>
            <h4 class="mini-title">ì£¼ë¬¸ ì œì‘ í™•ì¸</h4>
            <button class="mini-play" data-scenario="chat_order">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ì±„íŒ…</span></div>
            <h4 class="mini-title">ë°°ì†¡ ì§€ì—° ë¬¸ì˜</h4>
            <button class="mini-play" data-scenario="chat_shipping_delay">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
        </div>
        <div class="nav next" onclick="scrollTrack(this,1)">&#10095;</div>
      </div>
    </div>

    <!-- ===== ê·¸ë£¹ 3: ë©´ì ‘ ===== -->
    <div class="roadmap-group">
      <article class="course-main" data-cat="interview">
        <div class="thumb">
          <img src="{{ url_for('static', filename='assets/image/interview.png') }}" alt="ë©´ì ‘ ì§ˆë¬¸ step1">
        </div>
        <div class="body">
          <h3 class="title">ë©´ì ‘ ì§ˆë¬¸ë°›ê¸°</h3>
          <p class="desc">ì‹¤ì „ ëŒ€ë¹„ ë©´ì ‘ í›ˆë ¨ ë‹¨ê³„ë³„ ì—°ìŠµ</p>
        </div>
      </article>

      <div class="course-minis">
        <div class="nav prev" onclick="scrollTrack(this,-1)">&#10094;</div>
        <div class="track">
          <article class="mini-card">
            <div class="chips"><span class="chip">ë©´ì ‘</span></div>
            <h4 class="mini-title">Step 1: ê¸°ë³¸ ì§ˆë¬¸</h4>
            <button class="mini-play" data-scenario="interview_step1">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ë©´ì ‘</span></div>
            <h4 class="mini-title">Step 2: ìê¸°ì†Œê°œÂ·ê°•ì </h4>
            <button class="mini-play" data-scenario="interview_step2">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ë©´ì ‘</span></div>
            <h4 class="mini-title">Step 3: ìƒí™© ì§ˆë¬¸</h4>
            <button class="mini-play" data-scenario="interview_step3">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
        </div>
        <div class="nav next" onclick="scrollTrack(this,1)">&#10095;</div>
      </div>
    </div>

    <!-- ===== ê·¸ë£¹ 4: ì¼ìƒ ===== -->
    <div class="roadmap-group">
      <article class="course-main" data-cat="daily">
        <div class="thumb">
          <img src="{{ url_for('static', filename='assets/image/talk.png') }}" alt="ë°ì€ ì¸ì‚¬">
        </div>
        <div class="body">
          <h3 class="title">ë°ì€ ë¯¸ì†Œë¡œ ì¸ì‚¬í•˜ê¸°</h3>
          <p class="desc">ì²« ë§Œë‚¨Â·ì˜¤ëœë§Œì˜ ë§Œë‚¨ ëª¨ë‘ ìì—°ìŠ¤ëŸ½ê²Œ ì‹œì‘í•˜ê¸°</p>
        </div>
      </article>

      <div class="course-minis">
        <div class="nav prev" onclick="scrollTrack(this,-1)">&#10094;</div>
        <div class="track">
          <article class="mini-card">
            <div class="chips"><span class="chip">ì¼ìƒ</span></div>
            <h4 class="mini-title">ì•ˆë¶€ ë¬»ê¸°</h4>
            <button class="mini-play" data-scenario="greeting">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ì¼ìƒ</span></div>
            <h4 class="mini-title">ì•½ì† ì¡ê¸°</h4>
            <button class="mini-play" data-scenario="make_appointment">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
          <article class="mini-card">
            <div class="chips"><span class="chip">ì¼ìƒ</span></div>
            <h4 class="mini-title">ì·¨ë¯¸ ëŒ€í™”</h4>
            <button class="mini-play" data-scenario="hobby_chat">
              <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </button>
          </article>
        </div>
        <div class="nav next" onclick="scrollTrack(this,1)">&#10095;</div>
      </div>
    </div>

  </section>
</main>
{% endblock %}

{% block scripts %}
<script>
  // ì¢Œìš° ìŠ¬ë¼ì´ë“œ ê¸°ëŠ¥
  function scrollTrack(btn, dir) {
    const track = btn.parentElement.querySelector('.track');
    const card = track.querySelector('.mini-card');
    if (!card) return;
    const move = card.offsetWidth + 16;
    track.scrollBy({ left: dir * move * 1.5, behavior: 'smooth' });
  }

  // ì¹´í…Œê³ ë¦¬ í•„í„°
  document.querySelectorAll('.category-nav .cat').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.category-nav .cat').forEach(b => b.classList.remove('is-active'));
      btn.classList.add('is-active');
      const cat = btn.dataset.cat;
      filterCategory(cat);
    });
  });

  // í•„í„° í•¨ìˆ˜ ë¶„ë¦¬
  function filterCategory(cat) {
    document.querySelectorAll('.roadmap-group').forEach(group => {
      const main = group.querySelector('.course-main');
      group.style.display = (cat === 'all' || main.dataset.cat === cat) ? '' : 'none';
    });
  }

  // URL íŒŒë¼ë¯¸í„°(cat) ê°ì§€ â†’ ìë™ í•„í„°
  document.addEventListener('DOMContentLoaded', () => {
    const params = new URLSearchParams(window.location.search);
    const cat = params.get('cat');
    if (cat) {
      document.querySelectorAll('.category-nav .cat').forEach(btn => {
        btn.classList.toggle('is-active', btn.dataset.cat === cat);
      });
      filterCategory(cat);
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
  });

  // ë¯¸ë‹ˆì¹´ë“œ ì‹œë‚˜ë¦¬ì˜¤ ì—°ê²° (í•˜ë‚˜ì˜ ê·œì¹™ìœ¼ë¡œ í†µì¼)
  document.querySelectorAll('.mini-play').forEach(btn=>{
    btn.addEventListener('click', () => {
      const scenario = btn.dataset.scenario;

      // ì „í™”: ìƒë‹´ ì˜ˆì•½/ë°°ì†¡ ë¬¸ì˜/ì˜ˆì•½ ë³€ê²½ì€ ëª¨ë‘ /call ê³µí†µ API íë¦„
      if (scenario === "call_consult") {
        window.location.href = "/call?scenario=consult";
        return;
      }
      if (scenario === "call_shipping") {
        window.location.href = "/call?scenario=shipping";
        return;
      }
      if (scenario === "call_reschedule") {
        window.location.href = "/call?scenario=reschedule";
        return;
      }

      // ì±„íŒ…: êµí™˜/ì£¼ë¬¸ì œì‘ í™•ì¸ê³¼ ë™ì¼í•˜ê²Œ ë‚˜ë¨¸ì§€ ì‹ ê·œ ì‹œë‚˜ë¦¬ì˜¤ë„ ëª¨ë‘ /chat ê³µí†µ API íë¦„
      if (scenario === "chat_exchange") {
        window.location.href = "/chat?scenario=exchange"; return;
      }
      if (scenario === "chat_order") {
        window.location.href = "/chat?scenario=order"; return;
      }
      if (scenario === "chat_shipping_delay") {
        window.location.href = "/chat?scenario=shipping_delay"; return;
      }
      if (scenario === "interview_step1") {
        window.location.href = "/chat?scenario=interview_step1"; return;
      }
      if (scenario === "interview_step2") {
        window.location.href = "/chat?scenario=interview_step2"; return;
      }
      if (scenario === "interview_step3") {
        window.location.href = "/chat?scenario=interview_step3"; return;
      }
      if (scenario === "greeting") {
        window.location.href = "/chat?scenario=greeting"; return;
      }
      if (scenario === "make_appointment") {
        window.location.href = "/chat?scenario=make_appointment"; return;
      }
      if (scenario === "hobby_chat") {
        window.location.href = "/chat?scenario=hobby_chat"; return;
      }

      alert("ì´ ì‹œë‚˜ë¦¬ì˜¤ëŠ” ì•„ì§ ì¤€ë¹„ì¤‘ì…ë‹ˆë‹¤.");
    });
  });
</script>
{% endblock %}